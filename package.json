{
  "name": "feedbin-mailer",
  "scripts": {
    "app:local:build": "bash docker/build.local.sh",
    "app:local:push": "docker push karllhughes/fbm-mailer && docker push karllhughes/fbm-collector && docker push karllhughes/fbm-social",

    "app:prod:deploy": "docker run --rm --env-file $(pwd)/.env.prod -v $(pwd)/docker:/docker chickenzord/hyper sh /docker/deploy.hyper.sh",
    "collector:prod:run": "hyper run --size s3 --name fbm-collector-1 --rm --env-file .env.prod --link fbm-postgres-1:postgres karllhughes/fbm-collector",
    "mailer:prod:run": "hyper run --size s3 --name fbm-mailer-1 --rm --env-file .env.prod --link fbm-postgres-1:postgres karllhughes/fbm-mailer",
    "social:prod:run": "hyper run --size s3 --name fbm-social-1 --rm --env-file .env.prod --link fbm-postgres-1:postgres karllhughes/fbm-social",

    "db:prod:up": "sh docker/dbup.hyper.sh",
    "db:prod:migrate": "hyper exec -it fbm-postgres-1 psql -U postgres -a -f /database/schema.sql",
    "db:prod:down": "hyper rm -f fbm-postgres-1",

    "db:local:up": "docker run -d --rm --name fbm-postgres -p 5432:5432 --env-file $(pwd)/.env -v $(pwd)/.data:/var/lib/postgresql/data -v $(pwd)/database:/database postgres:9.6",
    "db:local:migrate": "docker exec -it fbm-postgres psql -U postgres -a -f /database/schema.sql",
    "db:local:down": "docker rm -f fbm-postgres",

    "collector:local:build": "docker build -t karllhughes/fbm-collector --build-arg project_dir=collector .",
    "collector:local:run": "docker run --rm --name fbm-collector --env-file $(pwd)/.env -v $(pwd)/collector:/app --link fbm-postgres:postgres karllhughes/fbm-collector",

    "mailer:local:build": "docker build -t karllhughes/fbm-mailer --build-arg project_dir=mailer .",
    "mailer:local:run": "docker run --rm --name fbm-mailer --env-file $(pwd)/.env -v $(pwd)/mailer:/app --link fbm-postgres:postgres karllhughes/fbm-mailer",

    "social:local:build": "docker build -t karllhughes/fbm-social --build-arg project_dir=social .",
    "social:local:run": "docker run --rm --name fbm-social --env-file $(pwd)/.env -v $(pwd)/social:/app --link fbm-postgres:postgres karllhughes/fbm-social"
  }
}
